{"ast":null,"code":"import { ADD_TO_FAVORITE_FAILURE, ADD_TO_FAVORITE_REQUEST, ADD_TO_FAVORITE_SUCCESS, GET_USER_FAILURE, GET_USER_REQUEST, GET_USER_SUCCESS, LOGIN_FAILURE, LOGIN_REQUEST, LOGIN_SUCCESS, LOGOUT, REGISTER_FAILURE, REGISTER_REQUEST, REGISTER_SUCCESS } from \"./ActionType\";\nimport axios from \"axios\";\nimport { API_URL } from \"../../commponent/config/api\";\nconst setJWT = token => {\n  if (token) localStorage.setItem(\"jwt\", token);\n};\nconst clearJWT = () => {\n  localStorage.removeItem(\"jwt\");\n};\nexport const registerUser = reqData => async dispatch => {\n  dispatch({\n    type: REGISTER_REQUEST\n  });\n  try {\n    const {\n      data\n    } = await axios.post(`${API_URL}/auth/signup`, reqData.userData);\n    setJWT(data.jwt);\n    reqData.navigate(data.role === \"ROLE_RESTAURANT_OWNER\" ? \"/admin/restaurant\" : \"/\");\n    dispatch({\n      type: REGISTER_SUCCESS,\n      payload: data.jwt\n    });\n    console.log(\"Register success\", data);\n  } catch (error) {\n    var _error$response;\n    dispatch({\n      type: REGISTER_FAILURE,\n      payload: ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || error.message\n    });\n    console.log(\"Register error\", error);\n  }\n};\nexport const loginUser = reqData => async dispatch => {\n  dispatch({\n    type: LOGIN_REQUEST\n  });\n  try {\n    const {\n      data\n    } = await axios.post(`${API_URL}/auth/signin`, reqData.userData);\n    if (data.jwt) {\n      setJWT(data.jwt);\n      reqData.navigate(data.role === \"ROLE_RESTAURANT_OWNER\" ? \"/admin/restaurant\" : \"/\");\n      dispatch({\n        type: LOGIN_SUCCESS,\n        payload: data.jwt\n      });\n      console.log(\"Login success\", data);\n    } else {\n      throw new Error(\"Login successful but no token received\");\n    }\n  } catch (error) {\n    var _error$response2;\n    dispatch({\n      type: LOGIN_FAILURE,\n      payload: ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data) || error.message\n    });\n    console.log(\"Login error\", error);\n  }\n};\nexport const getUser = jwt => async dispatch => {\n  if (!jwt) return dispatch({\n    type: GET_USER_FAILURE,\n    payload: \"JWT is required\"\n  });\n  dispatch({\n    type: GET_USER_REQUEST\n  });\n  try {\n    const {\n      data\n    } = await axios.get(`${API_URL}/api/user/profile`, {\n      headers: {\n        Authorization: `Bearer ${jwt}`\n      }\n    });\n    dispatch({\n      type: GET_USER_SUCCESS,\n      payload: data\n    });\n    console.log(\"User fetched successfully\", data);\n  } catch (error) {\n    var _error$response3;\n    dispatch({\n      type: GET_USER_FAILURE,\n      payload: ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data) || error.message\n    });\n    console.log(\"Fetch user error\", error);\n  }\n};\nexport const addToFavorite = (jwt, restaurantId) => async dispatch => {\n  if (!jwt) {\n    return dispatch({\n      type: ADD_TO_FAVORITE_FAILURE,\n      payload: \"JWT is required\"\n    });\n  }\n\n  // Log the restaurant ID directly\n  console.log(\"Adding restaurant to favorites with ID:\", restaurantId);\n  dispatch({\n    type: ADD_TO_FAVORITE_REQUEST\n  });\n  try {\n    const {\n      data\n    } = await axios.put(`${API_URL}/api/restaurants/${restaurantId}/add-favorites`, {},\n    // Assuming no body is needed for this request\n    {\n      headers: {\n        Authorization: `Bearer ${jwt}`\n      }\n    });\n    dispatch({\n      type: ADD_TO_FAVORITE_SUCCESS,\n      payload: data\n    });\n    console.log(\"Added to favorite\", data);\n  } catch (error) {\n    var _error$response4;\n    dispatch({\n      type: ADD_TO_FAVORITE_FAILURE,\n      payload: ((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.data) || error.message\n    });\n    console.log(\"Add to favorite error\", error);\n  }\n};\nexport const logout = () => dispatch => {\n  clearJWT();\n  dispatch({\n    type: LOGOUT\n  });\n  console.log(\"Logout success\");\n};","map":{"version":3,"names":["ADD_TO_FAVORITE_FAILURE","ADD_TO_FAVORITE_REQUEST","ADD_TO_FAVORITE_SUCCESS","GET_USER_FAILURE","GET_USER_REQUEST","GET_USER_SUCCESS","LOGIN_FAILURE","LOGIN_REQUEST","LOGIN_SUCCESS","LOGOUT","REGISTER_FAILURE","REGISTER_REQUEST","REGISTER_SUCCESS","axios","API_URL","setJWT","token","localStorage","setItem","clearJWT","removeItem","registerUser","reqData","dispatch","type","data","post","userData","jwt","navigate","role","payload","console","log","error","_error$response","response","message","loginUser","Error","_error$response2","getUser","get","headers","Authorization","_error$response3","addToFavorite","restaurantId","put","_error$response4","logout"],"sources":["C:/Users/gangw/OneDrive/Desktop/online-frontend/src/State/Authentication/Action.js"],"sourcesContent":["import {\r\n  ADD_TO_FAVORITE_FAILURE,\r\n  ADD_TO_FAVORITE_REQUEST,\r\n  ADD_TO_FAVORITE_SUCCESS,\r\n  GET_USER_FAILURE,\r\n  GET_USER_REQUEST,\r\n  GET_USER_SUCCESS,\r\n  LOGIN_FAILURE,\r\n  LOGIN_REQUEST,\r\n  LOGIN_SUCCESS,\r\n  LOGOUT,\r\n  REGISTER_FAILURE,\r\n  REGISTER_REQUEST,\r\n  REGISTER_SUCCESS,\r\n} from \"./ActionType\";\r\nimport axios from \"axios\";\r\nimport { API_URL } from \"../../commponent/config/api\";\r\n\r\nconst setJWT = (token) => {\r\n  if (token) localStorage.setItem(\"jwt\", token);\r\n};\r\n\r\nconst clearJWT = () => {\r\n  localStorage.removeItem(\"jwt\");\r\n};\r\n\r\nexport const registerUser = (reqData) => async (dispatch) => {\r\n  dispatch({ type: REGISTER_REQUEST });\r\n  try {\r\n    const { data } = await axios.post(\r\n      `${API_URL}/auth/signup`,\r\n      reqData.userData\r\n    );\r\n    setJWT(data.jwt);\r\n    reqData.navigate(\r\n      data.role === \"ROLE_RESTAURANT_OWNER\" ? \"/admin/restaurant\" : \"/\"\r\n    );\r\n    dispatch({ type: REGISTER_SUCCESS, payload: data.jwt });\r\n    console.log(\"Register success\", data);\r\n  } catch (error) {\r\n    dispatch({\r\n      type: REGISTER_FAILURE,\r\n      payload: error.response?.data || error.message,\r\n    });\r\n    console.log(\"Register error\", error);\r\n  }\r\n};\r\n\r\nexport const loginUser = (reqData) => async (dispatch) => {\r\n  dispatch({ type: LOGIN_REQUEST });\r\n  try {\r\n    const { data } = await axios.post(\r\n      `${API_URL}/auth/signin`,\r\n      reqData.userData\r\n    );\r\n\r\n    if (data.jwt) {\r\n      setJWT(data.jwt);\r\n      reqData.navigate(\r\n        data.role === \"ROLE_RESTAURANT_OWNER\" ? \"/admin/restaurant\" : \"/\"\r\n      );\r\n      dispatch({ type: LOGIN_SUCCESS, payload: data.jwt });\r\n      console.log(\"Login success\", data);\r\n    } else {\r\n      throw new Error(\"Login successful but no token received\");\r\n    }\r\n  } catch (error) {\r\n    dispatch({\r\n      type: LOGIN_FAILURE,\r\n      payload: error.response?.data || error.message,\r\n    });\r\n    console.log(\"Login error\", error);\r\n  }\r\n};\r\n\r\nexport const getUser = (jwt) => async (dispatch) => {\r\n  if (!jwt)\r\n    return dispatch({ type: GET_USER_FAILURE, payload: \"JWT is required\" });\r\n\r\n  dispatch({ type: GET_USER_REQUEST });\r\n  try {\r\n    const { data } = await axios.get(`${API_URL}/api/user/profile`, {\r\n      headers: {\r\n        Authorization: `Bearer ${jwt}`,\r\n      },\r\n    });\r\n    dispatch({ type: GET_USER_SUCCESS, payload: data });\r\n    console.log(\"User fetched successfully\", data);\r\n  } catch (error) {\r\n    dispatch({\r\n      type: GET_USER_FAILURE,\r\n      payload: error.response?.data || error.message,\r\n    });\r\n    console.log(\"Fetch user error\", error);\r\n  }\r\n};\r\n\r\nexport const addToFavorite = (jwt, restaurantId) => async (dispatch) => {\r\n  if (!jwt) {\r\n    return dispatch({\r\n      type: ADD_TO_FAVORITE_FAILURE,\r\n      payload: \"JWT is required\",\r\n    });\r\n  }\r\n\r\n  // Log the restaurant ID directly\r\n  console.log(\"Adding restaurant to favorites with ID:\", restaurantId);\r\n\r\n  dispatch({ type: ADD_TO_FAVORITE_REQUEST });\r\n  try {\r\n    const { data } = await axios.put(\r\n      `${API_URL}/api/restaurants/${restaurantId}/add-favorites`,\r\n      {}, // Assuming no body is needed for this request\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${jwt}`,\r\n        },\r\n      }\r\n    );\r\n    dispatch({ type: ADD_TO_FAVORITE_SUCCESS, payload: data });\r\n    console.log(\"Added to favorite\", data);\r\n  } catch (error) {\r\n    dispatch({\r\n      type: ADD_TO_FAVORITE_FAILURE,\r\n      payload: error.response?.data || error.message,\r\n    });\r\n    console.log(\"Add to favorite error\", error);\r\n  }\r\n};\r\n\r\nexport const logout = () => (dispatch) => {\r\n  clearJWT();\r\n  dispatch({ type: LOGOUT });\r\n  console.log(\"Logout success\");\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}